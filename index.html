<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>A Special Question</title>
    <style>
        /* --- CSS VARIABLES & RESET --- */
        :root {
            --primary-pink: #ff7eb3;
            --deep-red: #ff3e3e;
            --success-green: #28a745;
            --bg-gradient: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
            --font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            --btn-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: var(--bg-gradient);
            font-family: var(--font-family);
            overflow: hidden; /* Critical for the running button */
            user-select: none;
        }

        /* --- TYPOGRAPHY --- */
        h1 {
            font-size: 2.5rem;
            color: #333;
            margin-bottom: 2.5rem;
            text-align: center;
            padding: 0 20px;
            animation: float 3s ease-in-out infinite;
            z-index: 10;
        }

        .highlight {
            color: var(--deep-red);
            font-weight: 800;
        }

        /* --- BUTTON CONTAINER --- */
        .button-group {
            position: relative;
            display: flex;
            gap: 20px;
            z-index: 10;
        }

        /* --- SHARED BUTTON STYLES --- */
        .btn {
            padding: 16px 42px;
            font-size: 1.25rem;
            font-weight: 700;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: var(--btn-shadow);
            outline: none;
            letter-spacing: 0.5px;
            white-space: nowrap;
        }

        .btn:active {
            transform: scale(0.95);
        }

        /* --- YES BUTTON --- */
        #btn-yes {
            background-color: var(--success-green);
            color: white;
            position: relative; /* Stays in flow initially */
        }
        
        #btn-yes:hover {
            background-color: #218838;
            transform: scale(1.1);
        }

        /* --- NO BUTTON --- */
        #btn-no {
            background-color: var(--deep-red);
            color: white;
            /* Absolute is set via JS, but we prep transitions */
            transition: top 0.3s ease, left 0.3s ease, transform 0.1s;
        }

        /* --- SUCCESS STATE --- */
        #confirmation {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 20;
            width: 100%;
        }

        #confirmation h2 {
            font-size: 3rem;
            color: var(--deep-red);
            margin: 0;
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        #confirmation p {
            font-size: 1.5rem;
            color: #555;
            margin-top: 10px;
        }

        /* --- FIREWORKS CANVAS --- */
        #canvas-fireworks {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }

        /* --- ANIMATIONS --- */
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Mobile Adjustments */
        @media (max-width: 600px) {
            h1 { font-size: 1.8rem; }
            .btn { padding: 12px 30px; font-size: 1rem; }
        }
    </style>
</head>
<body>

    <h1 id="main-text">Will you be my <span class="highlight">girlfriend?</span> ❤️</h1>
    
    <div class="button-group">
        <button id="btn-yes" class="btn">YES</button>
        <button id="btn-no" class="btn">NO</button>
    </div>

    <div id="confirmation">
        <h2>Yay! ❤️</h2>
        <h3>Best decision ever!</h3>
    </div>

    <canvas id="canvas-fireworks"></canvas>

    <script>
        /**
         * PROFESSIONAL LOGIC IMPLEMENTATION
         * Handles collisions, resizing, high-performance animation,
         * and prevents the NO button from ever being clicked.
         */

        const btnYes = document.getElementById('btn-yes');
        const btnNo = document.getElementById('btn-no');
        const mainText = document.getElementById('main-text');
        const confirmation = document.getElementById('confirmation');
        const canvas = document.getElementById('canvas-fireworks');
        const ctx = canvas.getContext('2d');

        // State tracking
        let isNoBtnAbsolute = false;

        // --- THE "RUNAWAY" LOGIC ---

        function moveButton() {
            // 1. Get Viewport Dimensions
            // We subtract padding to keep button away from absolute edges
            const padding = 20; 
            const viewportWidth = window.innerWidth - padding;
            const viewportHeight = window.innerHeight - padding;
            
            // 2. Get Button Dimensions
            const btnRect = btnNo.getBoundingClientRect();
            const btnWidth = btnRect.width;
            const btnHeight = btnRect.height;

            // 3. Get YES Button Safe Zone (Collision Avoidance)
            const yesRect = btnYes.getBoundingClientRect();
            // Define a buffer around YES button where NO cannot land
            const safeBuffer = 50; 
            const forbiddenZone = {
                left: yesRect.left - safeBuffer,
                right: yesRect.right + safeBuffer,
                top: yesRect.top - safeBuffer,
                bottom: yesRect.bottom + safeBuffer
            };

            let newX, newY;
            let isOverlapping = true;
            let attempts = 0;

            // 4. Calculate coordinates until we find a safe spot
            while (isOverlapping && attempts < 50) {
                newX = Math.random() * (viewportWidth - btnWidth);
                newY = Math.random() * (viewportHeight - btnHeight);
                
                // Ensure positive coordinates (top-left boundary)
                newX = Math.max(padding, newX);
                newY = Math.max(padding, newY);

                // Check collision with Forbidden Zone
                const inX = newX + btnWidth > forbiddenZone.left && newX < forbiddenZone.right;
                const inY = newY + btnHeight > forbiddenZone.top && newY < forbiddenZone.bottom;

                if (inX && inY) {
                    isOverlapping = true; // Try again
                } else {
                    isOverlapping = false; // Found a safe spot
                }
                attempts++;
            }

            // 5. Apply Position
            if (!isNoBtnAbsolute) {
                btnNo.style.position = 'fixed'; // Use fixed to handle scrolling gracefully
                isNoBtnAbsolute = true;
            }
            
            btnNo.style.left = `${newX}px`;
            btnNo.style.top = `${newY}px`;
        }

        // --- EVENT LISTENERS FOR "NO" BUTTON ---
        
        // 1. Mouse Interaction
        btnNo.addEventListener('mouseover', moveButton);
        
        // 2. Touch Interaction (Mobile)
        btnNo.addEventListener('touchstart', (e) => {
            e.preventDefault(); // Prevents "tap" behavior
            moveButton();
        });

        // 3. Click Hijack (If user is extremely fast)
        btnNo.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopImmediatePropagation();
            moveButton(); // Just moves again, refuses to submit
        });

        // 4. Focus/Keyboard Hijack (Accessibility Trap)
        btnNo.addEventListener('focus', moveButton);


        // --- SUCCESS LOGIC ---

        btnYes.addEventListener('click', () => {
            // Hide UI
            mainText.style.display = 'none';
            btnYes.style.display = 'none';
            btnNo.style.display = 'none';

            // Show Confirmation
            confirmation.style.display = 'block';

            // Start Fireworks
            startFireworks();
        });


        // --- FIREWORKS ENGINE (Optimized) ---

        let particles = [];
        
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.color = color;
                const angle = Math.random() * Math.PI * 2;
                const velocity = Math.random() * 4 + 1; // Random speed
                this.dx = Math.cos(angle) * velocity;
                this.dy = Math.sin(angle) * velocity;
                this.alpha = 1;
                this.decay = Math.random() * 0.015 + 0.01; // Random fade speed
                this.gravity = 0.05; // Adds weight to particles
            }

            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.beginPath();
                ctx.arc(this.x, this.y, 3, 0, Math.PI * 2, false);
                ctx.fillStyle = this.color;
                ctx.fill();
                ctx.restore();
            }

            update() {
                this.x += this.dx;
                this.y += this.dy;
                this.dy += this.gravity; // Apply gravity
                this.alpha -= this.decay;
            }
        }

        function animateFireworks() {
            requestAnimationFrame(animateFireworks);
            // Create trail effect
            ctx.fillStyle = 'rgba(255, 255, 255, 0.1)'; 
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            particles.forEach((particle, index) => {
                if (particle.alpha > 0) {
                    particle.update();
                    particle.draw();
                } else {
                    particles.splice(index, 1);
                }
            });
        }

        function explode(x, y) {
            const colors = ['#ff4d4d', '#ff9f43', '#feca57', '#28a745', '#54a0ff', '#5f27cd'];
            for (let i = 0; i < 40; i++) {
                const color = colors[Math.floor(Math.random() * colors.length)];
                particles.push(new Particle(x, y, color));
            }
        }

        function startFireworks() {
            animateFireworks();
            
            // Initial Burst
            explode(window.innerWidth / 2, window.innerHeight / 2);

            // Random bursts loop
            let count = 0;
            const interval = setInterval(() => {
                const x = Math.random() * canvas.width;
                const y = Math.random() * (canvas.height * 0.7); // Top 70% of screen
                explode(x, y);
                count++;
                if (count > 20) clearInterval(interval);
            }, 400);
        }

    </script>
</body>
</html>
